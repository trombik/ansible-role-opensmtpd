---

hosts_enable_localhost: yes
hosts_map:
  "192.168.21.200":
    - server1
  "192.168.21.100":
    - client1
hostname_fqdn: "{{ project_hostname_fqdn }}"
freebsd_pkg_repo:
  FreeBSD:
    enabled: "false"
    state: present
  FreeBSD_latest:
    enabled: "true"
    state: present
    url: pkg+https://pkg.FreeBSD.org/${ABI}/latest
    mirror_type: srv
    signature_type: fingerprints
    fingerprints: /usr/share/keys/pkg
    priority: 100

redhat_repo:
  epel:
    mirrorlist: "http://mirrors.fedoraproject.org/mirrorlist?repo=epel-{{ ansible_distribution_major_version }}&arch={{ ansible_architecture }}"
    gpgcheck: yes
    enabled: yes
    gpgkey: https://getfedora.org/static/fedora.gpg

opensmtpd_extra_packages: "{% if ansible_os_family == 'FreeBSD' %}[ 'opensmtpd-extras-table-passwd' ]{% else %}[]{% endif %}"
opensmtpd_extra_groups: "{% if ansible_os_family == 'FreeBSD' %}[ 'nobody' ]{% else %}[ 'games' ]{% endif %}"

opensmtpd_config: |
  {% for list in opensmtpd_tables %}
  {% if list.type == 'passwd' and ansible_distribution == 'Ubuntu' and (ansible_distribution_version == '18.04' or ansible_distribution_version == '14.04') %}  # noqa 204
  # XXX at the moment (2018/05/20), the version of opensmtpd-extras is
  # behind opensmtpd, causing "table-api: bad API version".
  # https://packages.ubuntu.com/bionic/opensmtpd-extras
  #
  # skip passwd table until synced version is released
  #
  # also, opensmtpd-extras for ubuntu 14.04 was removed
  {% else %}
  table {{ list.name }} {{ list.type }}:{{ list.path }}{% if list['type'] == 'db' %}.db{% endif %}
  {% endif %}

  {% endfor %}
  listen on {{ project_listen_on_interface }} port {{ project_listen_on_port }}
  {{ project_rules }}
